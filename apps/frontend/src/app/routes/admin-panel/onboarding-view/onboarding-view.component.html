<mat-spinner *ngIf="onboardingSteps.loading"></mat-spinner>
<ng-container *ngIf="onboardingFields">
  <div *ngFor="let step of onboardingFields | keyvalue: keepOrder" [ngSwitch]="step.key">
    <h3 *ngSwitchCase="0">Proof of Business</h3>
    <h3 *ngSwitchCase="1">Owner Details</h3>
    <h3 *ngSwitchCase="2">Social Presence</h3>
    <h3 *ngSwitchCase="3">Add Members</h3>
    <h3 *ngSwitchCase="4">Subscription Configuration</h3>

    <ul class="onboarding-step-meta">
      <li *ngFor="let field of step.value; let idx = index" class="mb-2" [class.is-admin]="adminView">
        <div class="flex align-middle">
          <ui-icon-button class="mr-4" size="m"
            *ngIf="adminView"
            (click)="addFieldIssue(step.key, idx)"
            [disabled]="field.valid || isActiveIssueMaker(step.key, idx)">
              add
          </ui-icon-button>

          <mat-checkbox class="mr-4"
            *ngIf="adminView"
            [(ngModel)]="field.valid"
            [checked]="field.issues?.length || field.valid"
            [disabled]="enactOnboarding.loading">
          </mat-checkbox>
          
          <p class="flex-1 flex"
            [class.cursor-pointer]="adminView">
            <b (click)="field.valid = !field.valid">
              {{ field.key | titlecase }}:
            </b> {{ field.value }}
          </p>
        </div>

        <app-onboarding-view-issue-maker
          [isActive]="isActiveIssueMaker(step.key, idx)"
          [field]="field">
        </app-onboarding-view-issue-maker>
      </li>
    </ul>

    <ui-hr></ui-hr>
  </div>

  <ui-button kind="primary" size="l"
    *ngIf="adminView"
    [loading]="enactOnboarding.loading"
    (click)="enactOnboardingProcess()">
      Enact
  </ui-button>
</ng-container>